import React, { useState, useEffect } from "react"
import { useAppContext } from "./Context"
import { Path } from './pathUtils'
import { SVGWrapper } from "./ContextSVG"

export default function RoadmapF({ scrollMin, scrollMax }) {
  let [allLengths, setAllLengths] = useState([])
  let [allOffsetLengths, setAllOffsetLengths] = useState([])
  let [allRatios, setAllRatios] = useState([0])
  let [allPrevRatios, setAllPrevRatios] = useState([0])
  let { scrolled } = useAppContext();

  function handleLength(f, newLength, position) {
    setAllLengths(prevLengths => {
      let copyLengths = [...prevLengths];
      copyLengths[position] = newLength;
      return copyLengths
    })
    setAllOffsetLengths(prevOffsets => {
      let copyOffsetLengths = [...prevOffsets];
      copyOffsetLengths[position] = newLength * f;
      return copyOffsetLengths
    })
  }

  useEffect(() => {
    if (allLengths.length > 0) {
      let totLength = allLengths.reduce((x, y) => x + y);
      let totOffsetLength = allOffsetLengths.reduce((x, y) => x + y);
      let allRatios = allLengths.map(itemLength => itemLength / totOffsetLength);
      let newPrevRatios = allLengths.map((itemLength, index) => {
        let prevOffsetLength = allOffsetLengths.reduce((acc, y, i) => {
          return (i < index ? acc + y : acc)
        }, 0);
        return prevOffsetLength / totOffsetLength
      })
      setAllRatios(allRatios)
      setAllPrevRatios(newPrevRatios)
    }
  }, [allLengths])
  // style={{transform: `translate(-50%, -${500*scrolled}px)`}} 
  return (
    <SVGWrapper myRatio={allRatios} prevRatio={allPrevRatios} scrollMin={scrollMin} scrollMax={scrollMax}>
      <div className='relative w-full h-fit flex flex-col '>

        <svg className='relative w-full px-4 left-1/2' style={{ transform: `translate(-50%, ${-0 * scrolled}px)` }} viewBox="0 0 807 214" fill="none" xmlns="http://www.w3.org/2000/svg">
          <Path position={0}  inverse={false} double={1} handleLength={(l,i)=>handleLength(2,l,i)} d="M403.5 69L453 139.5L403.5 210L354 139.5L403.5 69Z" fill="black" stroke="white" strokeWidth="4" />
          <path  d="M238.68 11.9268C240.765 11.9268 242.557 12.2939 244.054 13.028C245.581 13.7622 246.771 14.8047 247.622 16.1556C248.474 17.5065 248.9 19.1363 248.9 21.0452C248.9 22.9247 248.474 24.5545 247.622 25.9348C246.771 27.2857 245.581 28.3282 244.054 29.0624C242.557 29.7965 240.765 30.1636 238.68 30.1636H232.205V41H227.491V11.9268H238.68ZM237.931 26.111C240.016 26.111 241.543 25.6852 242.513 24.8335C243.511 23.9525 244.01 22.6897 244.01 21.0452C244.01 19.3713 243.511 18.1085 242.513 17.2569C241.543 16.3759 240.016 15.9353 237.931 15.9353H232.205V26.111H237.931ZM254.448 41V18.9748H258.457L258.897 22.9394C259.485 21.5004 260.351 20.4138 261.496 19.6796C262.671 18.9161 264.11 18.5343 265.813 18.5343C266.254 18.5343 266.694 18.5784 267.135 18.6665C267.575 18.7252 267.942 18.828 268.236 18.9748L267.575 23.1156C267.252 22.9981 266.885 22.91 266.474 22.8513C266.092 22.7632 265.564 22.7191 264.888 22.7191C263.978 22.7191 263.082 22.9687 262.201 23.468C261.32 23.9378 260.586 24.6573 259.999 25.6264C259.441 26.5955 259.162 27.8289 259.162 29.3267V41H254.448ZM281.687 18.5343C283.831 18.5343 285.725 18.9895 287.37 19.8999C289.015 20.8103 290.292 22.1318 291.202 23.8644C292.142 25.5677 292.612 27.6087 292.612 29.9874C292.612 32.3661 292.142 34.4218 291.202 36.1545C290.292 37.8577 289.015 39.1646 287.37 40.0749C285.725 40.9853 283.831 41.4405 281.687 41.4405C279.544 41.4405 277.65 40.9853 276.005 40.0749C274.36 39.1646 273.068 37.8577 272.129 36.1545C271.189 34.4218 270.719 32.3661 270.719 29.9874C270.719 27.6087 271.189 25.5677 272.129 23.8644C273.068 22.1318 274.36 20.8103 276.005 19.8999C277.65 18.9895 279.544 18.5343 281.687 18.5343ZM281.687 22.2345C280.366 22.2345 279.235 22.5429 278.296 23.1596C277.385 23.7469 276.68 24.6133 276.181 25.7586C275.682 26.9039 275.432 28.3135 275.432 29.9874C275.432 31.632 275.682 33.0416 276.181 34.2162C276.68 35.3616 277.385 36.2426 278.296 36.8593C279.235 37.4466 280.366 37.7403 281.687 37.7403C283.009 37.7403 284.125 37.4466 285.035 36.8593C285.946 36.2426 286.65 35.3616 287.15 34.2162C287.649 33.0416 287.899 31.632 287.899 29.9874C287.899 28.3135 287.649 26.9039 287.15 25.7586C286.65 24.6133 285.946 23.7469 285.035 23.1596C284.125 22.5429 283.009 22.2345 281.687 22.2345ZM306.999 41.4405C305.178 41.4405 303.519 40.9853 302.022 40.0749C300.553 39.1646 299.393 37.8577 298.542 36.1545C297.69 34.4512 297.264 32.4102 297.264 30.0315C297.264 27.5646 297.719 25.4796 298.63 23.7763C299.54 22.073 300.759 20.7809 302.286 19.8999C303.813 18.9895 305.487 18.5343 307.308 18.5343C309.187 18.5343 310.773 19.0482 312.065 20.0761C313.357 21.1039 314.223 22.4401 314.664 24.0847L314.135 24.5692V9.06349H318.849V41H314.664L314.312 35.0092L314.928 35.0532C314.723 36.3747 314.238 37.52 313.475 38.4891C312.711 39.4289 311.757 40.163 310.611 40.6916C309.495 41.1909 308.291 41.4405 306.999 41.4405ZM308.012 37.6522C309.275 37.6522 310.362 37.3291 311.272 36.6831C312.182 36.037 312.887 35.1266 313.387 33.9519C313.886 32.7773 314.135 31.3677 314.135 29.7231C314.135 28.196 313.886 26.8892 313.387 25.8026C312.887 24.6867 312.182 23.835 311.272 23.2477C310.391 22.6604 309.363 22.3667 308.189 22.3667C306.221 22.3667 304.694 23.0421 303.607 24.393C302.521 25.7439 301.977 27.6087 301.977 29.9874C301.977 32.3661 302.506 34.2456 303.563 35.6259C304.62 36.9767 306.104 37.6522 308.012 37.6522ZM334 41.4405C332.561 41.4405 331.225 41.1762 329.991 40.6476C328.787 40.119 327.818 39.2674 327.084 38.0927C326.35 36.918 325.983 35.3909 325.983 33.5114V18.9748H330.696V32.3221C330.696 34.319 331.122 35.6993 331.974 36.4628C332.825 37.197 334.015 37.5641 335.542 37.5641C336.276 37.5641 336.981 37.4466 337.656 37.2117C338.361 36.9474 338.992 36.5509 339.55 36.0223C340.108 35.4643 340.534 34.7595 340.828 33.9079C341.151 33.0563 341.312 32.0578 341.312 30.9125V18.9748H346.026V41H341.885L341.665 37.4319C340.901 38.8122 339.873 39.8253 338.581 40.4714C337.289 41.1175 335.762 41.4405 334 41.4405ZM362.904 18.5343C364.666 18.5343 366.164 18.7986 367.397 19.3272C368.66 19.8265 369.717 20.546 370.569 21.4857C371.421 22.4254 372.067 23.4973 372.507 24.7014L368.058 26.4634C367.676 25.1125 367.06 24.0847 366.208 23.3799C365.386 22.6457 364.299 22.2786 362.948 22.2786C361.627 22.2786 360.496 22.587 359.556 23.2037C358.617 23.791 357.897 24.6573 357.398 25.8026C356.928 26.9479 356.693 28.3575 356.693 30.0315C356.693 31.676 356.943 33.0709 357.442 34.2162C357.941 35.3616 358.661 36.2279 359.6 36.8152C360.54 37.4026 361.656 37.6962 362.948 37.6962C363.947 37.6962 364.813 37.5347 365.547 37.2117C366.281 36.8593 366.883 36.3747 367.353 35.758C367.853 35.1119 368.19 34.3337 368.367 33.4233L372.639 34.877C372.228 36.1985 371.582 37.3585 370.701 38.357C369.85 39.3261 368.778 40.0896 367.486 40.6476C366.193 41.1762 364.71 41.4405 363.036 41.4405C360.863 41.4405 358.94 40.9853 357.266 40.0749C355.592 39.1646 354.285 37.8577 353.345 36.1545C352.435 34.4218 351.98 32.3661 351.98 29.9874C351.98 27.6087 352.435 25.5677 353.345 23.8644C354.285 22.1318 355.577 20.8103 357.222 19.8999C358.896 18.9895 360.79 18.5343 362.904 18.5343ZM384.556 12.4994V34.3924C384.556 35.479 384.835 36.2719 385.393 36.7712C385.98 37.2704 386.759 37.52 387.728 37.52C388.521 37.52 389.211 37.4026 389.798 37.1676C390.385 36.9033 390.929 36.5509 391.428 36.1104L392.485 39.5463C391.81 40.1337 390.973 40.6035 389.974 40.9559C389.005 41.279 387.919 41.4405 386.715 41.4405C385.452 41.4405 384.292 41.2349 383.235 40.8238C382.177 40.4127 381.355 39.7519 380.768 38.8415C380.18 37.9018 379.872 36.6831 379.843 35.1854V13.8209L384.556 12.4994ZM392.133 18.9748V22.6751H375.614V18.9748H392.133ZM422.044 11.9268C426.596 11.9268 430.135 13.1895 432.66 15.7151C435.215 18.2113 436.492 21.794 436.492 26.4634C436.492 31.1327 435.215 34.7302 432.66 37.2557C430.135 39.7519 426.596 41 422.044 41H411.78V11.9268H422.044ZM422.044 36.9914C425.127 36.9914 427.477 36.081 429.092 34.2603C430.737 32.4102 431.559 29.8112 431.559 26.4634C431.559 23.1156 430.737 20.5313 429.092 18.7105C427.477 16.8604 425.127 15.9353 422.044 15.9353H416.494V36.9914H422.044ZM452.515 41.4405C450.312 41.4405 448.374 40.9853 446.7 40.0749C445.026 39.1646 443.719 37.8577 442.78 36.1545C441.869 34.4218 441.414 32.3661 441.414 29.9874C441.414 27.6087 441.869 25.5677 442.78 23.8644C443.719 22.1318 445.011 20.8103 446.656 19.8999C448.301 18.9895 450.165 18.5343 452.25 18.5343C454.394 18.5343 456.215 18.9748 457.713 19.8558C459.21 20.7368 460.356 21.9409 461.149 23.468C461.942 24.995 462.338 26.7277 462.338 28.6659C462.338 29.1945 462.323 29.6937 462.294 30.1636C462.265 30.6335 462.221 31.0446 462.162 31.397H444.454V27.7849H460.091L457.757 28.4897C457.757 26.4927 457.257 24.9657 456.259 23.9085C455.261 22.8219 453.895 22.2786 452.162 22.2786C450.9 22.2786 449.798 22.5723 448.859 23.1596C447.919 23.7469 447.199 24.628 446.7 25.8026C446.201 26.9479 445.951 28.3575 445.951 30.0315C445.951 31.676 446.216 33.0709 446.744 34.2162C447.273 35.3616 448.022 36.2279 448.991 36.8152C449.96 37.4026 451.105 37.6962 452.427 37.6962C453.895 37.6962 455.084 37.4172 455.995 36.8593C456.905 36.3013 457.625 35.5231 458.153 34.5246L461.897 36.2866C461.369 37.3438 460.649 38.2689 459.739 39.0618C458.858 39.8253 457.801 40.4127 456.567 40.8238C455.334 41.2349 453.983 41.4405 452.515 41.4405ZM472.872 9.06349V34.833C472.872 35.9195 473.062 36.6684 473.444 37.0795C473.826 37.4907 474.457 37.6962 475.338 37.6962C475.867 37.6962 476.307 37.6669 476.66 37.6081C477.042 37.52 477.511 37.3732 478.069 37.1676L477.541 40.6916C477.042 40.9266 476.469 41.1028 475.823 41.2203C475.177 41.3671 474.531 41.4405 473.885 41.4405C471.917 41.4405 470.463 40.9413 469.524 39.9428C468.613 38.9149 468.158 37.3438 468.158 35.2294V9.06349H472.872ZM484.392 15.2746C483.364 15.2746 482.571 15.025 482.013 14.5257C481.484 13.9971 481.22 13.263 481.22 12.3232C481.22 11.3835 481.484 10.664 482.013 10.1648C482.571 9.66551 483.364 9.4159 484.392 9.4159C485.39 9.4159 486.154 9.66551 486.682 10.1648C487.24 10.664 487.519 11.3835 487.519 12.3232C487.519 13.263 487.24 13.9971 486.682 14.5257C486.154 15.025 485.39 15.2746 484.392 15.2746ZM486.726 18.9748V41H482.013V18.9748H486.726ZM508.594 18.9748H513.527L504.761 41H499.607L490.797 18.9748H495.951L502.206 36.9033L508.594 18.9748ZM527.108 41.4405C524.905 41.4405 522.967 40.9853 521.293 40.0749C519.619 39.1646 518.312 37.8577 517.373 36.1545C516.462 34.4218 516.007 32.3661 516.007 29.9874C516.007 27.6087 516.462 25.5677 517.373 23.8644C518.312 22.1318 519.605 20.8103 521.249 19.8999C522.894 18.9895 524.758 18.5343 526.844 18.5343C528.987 18.5343 530.808 18.9748 532.306 19.8558C533.803 20.7368 534.949 21.9409 535.742 23.468C536.535 24.995 536.931 26.7277 536.931 28.6659C536.931 29.1945 536.916 29.6937 536.887 30.1636C536.858 30.6335 536.814 31.0446 536.755 31.397H519.047V27.7849H534.684L532.35 28.4897C532.35 26.4927 531.851 24.9657 530.852 23.9085C529.854 22.8219 528.488 22.2786 526.755 22.2786C525.493 22.2786 524.391 22.5723 523.452 23.1596C522.512 23.7469 521.792 24.628 521.293 25.8026C520.794 26.9479 520.544 28.3575 520.544 30.0315C520.544 31.676 520.809 33.0709 521.337 34.2162C521.866 35.3616 522.615 36.2279 523.584 36.8152C524.553 37.4026 525.698 37.6962 527.02 37.6962C528.488 37.6962 529.677 37.4172 530.588 36.8593C531.498 36.3013 532.218 35.5231 532.746 34.5246L536.491 36.2866C535.962 37.3438 535.242 38.2689 534.332 39.0618C533.451 39.8253 532.394 40.4127 531.16 40.8238C529.927 41.2349 528.576 41.4405 527.108 41.4405ZM542.883 41V18.9748L546.892 18.9748L547.332 22.9394C547.92 21.5004 548.786 20.4138 549.931 19.6796C551.106 18.9161 552.545 18.5343 554.248 18.5343C554.689 18.5343 555.129 18.5784 555.57 18.6665C556.01 18.7252 556.377 18.828 556.671 18.9748L556.01 23.1156C555.687 22.9981 555.32 22.91 554.909 22.8513C554.527 22.7632 553.999 22.7191 553.323 22.7191C552.413 22.7191 551.517 22.9687 550.636 23.468C549.755 23.9378 549.021 24.6573 548.434 25.6264C547.876 26.5955 547.597 27.8289 547.597 29.3267V41H542.883ZM580.461 18.9748L570.814 43.599C570.168 45.3023 569.463 46.6531 568.7 47.6516C567.965 48.6501 567.114 49.3696 566.145 49.8101C565.176 50.2506 564.045 50.4708 562.753 50.4708C561.696 50.4708 560.712 50.324 559.801 50.0303C558.92 49.766 558.142 49.3989 557.467 48.9291L558.612 45.2729C559.17 45.7428 559.757 46.0952 560.374 46.3301C561.02 46.565 561.71 46.6825 562.444 46.6825C563.237 46.6825 563.942 46.4622 564.559 46.0217C565.205 45.6106 565.778 44.7736 566.277 43.5109L567.246 41.1322L564.911 35.6699L558.039 18.9748H563.325L568.215 32.8066L569.493 36.9474L570.946 32.4102L575.571 18.9748H580.461Z" fill="white" />
        </svg>

        <h2 className='z-20 p-2 w-full text-sm font-light text-center outline-none -outline-offset-2 relative flex text-white font-sans ' >
          {`When we first meet we define the goals and resources of your project as well as the available time until completion.`}
        </h2>
        {/* <h2 className='z-20 p-2 bg-white/10 rounded-2xl backdrop-blur-sm outline-none -outline-offset-2 outline-white/20 relative flex text-sm font-light w-[40vw] text-center text-white font-sans ' >{`We take note of your\nvalues, existing branding\nand style preferences to\ngenerate ideas together`} </h2> */}
        {/* <h2 className='z-20 p-2 relative flex text-sm font-light w-[30vw] text-center text-white font-sans top-[70%] left-0' >{`I then transform the\nfinal design into the\nactual digital produc`}t</h2>
        <h2 className='z-20 p-2 relative flex text-sm font-light w-[30vw] text-center text-white font-sans top-[80%] left-0' >{`When the product is ready\nyou finally receive it.\nYes, you own all the code`}.</h2>
        <h2 className='z-20 p-2 relative flex text-sm font-light w-[30vw] text-center text-white font-sans top-[95%] left-0' >{`An apple a day keeps the doctor away.\nA maintenance plan is developed to\nanswer the needs of your product`}.</h2> */}


      </div>
    </SVGWrapper>
  )
}